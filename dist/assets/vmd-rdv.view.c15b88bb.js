var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,i=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,a)=>{for(var s in a||(a={}))t.call(a,s)&&i(e,s,a[s]);if(r)for(var s of r(a))n.call(a,s)&&i(e,s,a[s]);return e};import{r as s,t as o,f as c,g as l,i as d,A as h,j as u,L as p,S as m,R as f,l as y,a as v,b,h as g,k as S,m as D,n as x,o as T,q as w,s as _,u as k,C as A,d as C,v as $,w as M,T as P,p as I,x as L,e as R}from"./index.9f4535d5.js";import"./vendor.1d43dcfd.js";function B(e,t){s(2,arguments);var r=o(e),n=o(t),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function F(e,t){s(2,arguments);var r=o(e),n=o(t),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return 12*i+a}function E(e,t){s(2,arguments);var r=o(e),n=o(t);return r.getTime()-n.getTime()}function J(e){s(1,arguments);var t=o(e);return t.setHours(23,59,59,999),t}function N(e){s(1,arguments);var t=o(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function j(e){s(1,arguments);var t=o(e);return J(t).getTime()===N(t).getTime()}function V(e,t){s(2,arguments);var r,n=o(e),i=o(t),a=B(n,i),c=Math.abs(F(n,i));if(c<1)r=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*c);var l=B(n,i)===-a;j(o(e))&&1===c&&1===B(e,i)&&(l=!1),r=a*(c-Number(l))}return 0===r?0:r}function O(e,t){s(2,arguments);var r=E(e,t)/1e3;return r>0?Math.floor(r):Math.ceil(r)}function U(e){return function(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t=t||{})t.hasOwnProperty(r)&&(e[r]=t[r]);return e}({},e)}function X(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s(2,arguments);var n=r.locale||c;if(!n.formatDistance)throw new RangeError("locale must contain formatDistance property");var i=B(e,t);if(isNaN(i))throw new RangeError("Invalid time value");var a,d,h=U(r);h.addSuffix=Boolean(r.addSuffix),h.comparison=i,i>0?(a=o(t),d=o(e)):(a=o(e),d=o(t));var u,p=O(d,a),m=(l(d)-l(a))/1e3,f=Math.round((p-m)/60);if(f<2)return r.includeSeconds?p<5?n.formatDistance("lessThanXSeconds",5,h):p<10?n.formatDistance("lessThanXSeconds",10,h):p<20?n.formatDistance("lessThanXSeconds",20,h):p<40?n.formatDistance("halfAMinute",null,h):p<60?n.formatDistance("lessThanXMinutes",1,h):n.formatDistance("xMinutes",1,h):0===f?n.formatDistance("lessThanXMinutes",1,h):n.formatDistance("xMinutes",f,h);if(f<45)return n.formatDistance("xMinutes",f,h);if(f<90)return n.formatDistance("aboutXHours",1,h);if(f<1440){var y=Math.round(f/60);return n.formatDistance("aboutXHours",y,h)}if(f<2520)return n.formatDistance("xDays",1,h);if(f<43200){var v=Math.round(f/1440);return n.formatDistance("xDays",v,h)}if(f<86400)return u=Math.round(f/43200),n.formatDistance("aboutXMonths",u,h);if((u=V(d,a))<12){var b=Math.round(f/43200);return n.formatDistance("xMonths",b,h)}var g=u%12,S=Math.floor(u/12);return g<3?n.formatDistance("aboutXYears",S,h):g<9?n.formatDistance("overXYears",S,h):n.formatDistance("almostXYears",S+1,h)}
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const q=new WeakMap,Y=d((e=>t=>{if(!(t instanceof h)||t instanceof u||"style"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");const{committer:r}=t,{style:n}=r.element;let i=q.get(t);void 0===i&&(n.cssText=r.strings.join(" "),q.set(t,i=new Set)),i.forEach((t=>{t in e||(i.delete(t),-1===t.indexOf("-")?n[t]=null:n.removeProperty(t))}));for(const a in e)i.add(a),-1===a.indexOf("-")?n[a]=e[a]:n.setProperty(a,e[a])}));function H(e){return e*(Math.PI/180)}const z={"01":["38","73","74","39","71","69"],"02":["59","80","60","77","51","08"],"03":["42","71","58","18","23","63"],"04":["83","06","05","26","84","13"],"05":["04","26","38","73"],"06":["83","04"],"07":["48","30","84","26","38","69","43"],"08":["55","51","02","59"],"09":["31","11","66"],10:["89","21","52","51","77"],11:["09","31","81","34"],12:["34","30","48","15","46","82","81"],13:["30","84","83"],14:["27","61","50"],15:["48","43","63","19","46","12"],16:["17","79","86","87","24"],17:["85","79","16","33"],18:["36","41","45","89","58","03","23"],19:["23","87","24","46","15","63"],"2A":["2B"],"2B":["2A"],21:["10","89","58","71","39","70","52"],22:["29","56","35"],23:["87","19","63","03","18","36"],24:["17","16","87","19","46","47","33"],25:["39","70","90"],26:["84","04","05","38","69","07"],27:["76","60","95","78","28","61","14"],28:["27","78","91","45","41","72","61"],29:["22","56"],30:["34","12","48","07","26","84","13"],31:["65","32","82","81","11","09"],32:["31","65","64","40","47","82"],33:["17","24","47","40"],34:["11","81","12","30"],35:["50","53","49","44","56","22"],36:["37","41","18","23","87","86"],37:["41","36","86","49","72"],38:["05","73","01","69","07","26","05"],39:["01","71","21","70","25"],40:["33","47","32","64"],41:["72","37","36","18","45","28"],42:["43","69","71","03","63"],43:["48","07","69","42","63","15"],44:["56","35","53","49","85"],45:["91","77","28","41","18","58","89"],46:["15","19","24","47","82","12"],47:["33","40","32","82","46","24"],48:["12","30","07","43","15"],49:["44","53","72","37","86","79","85"],50:["14","61","53","35"],51:["02","77","10","52","55","08"],52:["21","70","88","55","51","10"],53:["49","72","61","50","35","44"],54:["57","67","88","55"],55:["54","88","52","51","08"],56:["29","22","35","44"],57:["67","88","54"],58:["03","71","21","89","45","18"],59:["02","80","62","08"],60:["02","80","76","27","95","77"],61:["14","27","28","72","53","50"],62:["80","59","02"],63:["15","43","42","03","23","19"],64:["40","32","65"],65:["64","32","31"],66:["09","11"],67:["68","88","54","57"],68:["90","70","88","67"],69:["01","71","42","43","07","26","38"],70:["21","39","25","90","88","52"],71:["03","42","69","01","39","21","58"],72:["28","61","53","49","37","41"],73:["74","01","38","05"],74:["73","01"],75:["92","93","94"],76:["80","60","27"],77:["89","10","51","02","60","93","91","45"],78:["95","27","28","91","92"],79:["17","85","49","86","16"],80:["62","59","02","60","76"],81:["11","34","12","82","31"],82:["32","31","81","12","46","47"],83:["13","84","04","06"],84:["13","04","26","07","30"],85:["44","49","79","17"],86:["36","37","49","79","16","87"],87:["23","19","24","16","86"],88:["70","90","68","67","57","54","55","52"],89:["58","21","10","77","45"],90:["25","70","88","68"],91:["45","28","77","78","92","94"],92:["75","95","78","93"],93:["92","95","94","77"],94:["77","75","92","93","91"],95:["78","27","60","93","92"],971:[],972:[],973:[],974:[],976:[],om:[]};function G(e){return new Promise((t=>setTimeout(t,e)))}class K{constructor(e){this.array=e}concat(e){return this.array=this.array.concat(e),this}map(e){return new K(this.array.map(e))}filter(e){return this.array=this.array.filter(e),this}sort(e){return this.array.sort(e),this}sortBy(e){return this.sort(((t,r)=>e(t).localeCompare(e(r))))}build(){return this.array}static from(e){return new K(e)}}var W=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,Z=(e,t,r,n)=>{for(var i,a=n>1?void 0:n?Q(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n?i(t,r,a):i(a))||a);return n&&a&&W(t,r,a),a};class ee extends p{constructor(){super(...arguments),this.DELAI_VERIFICATION_MISE_A_JOUR=45e3,this.lieuxParDepartementAffiches=void 0,this.searchInProgress=!1,this.miseAJourDisponible=!1,this.currentSearch=void 0,this.derniereCommuneSelectionnee=void 0,this.lieuBackgroundRefreshIntervalId=void 0}get totalCreneaux(){return this.lieuxParDepartementAffiches?this.lieuxParDepartementAffiches.lieuxAffichables.reduce(((e,t)=>e+t.appointment_count),0):0}beforeNewSearchFromLocation(e){return e}async onSearchSelected(e){const t=e.detail;this.goToNewSearch(this.beforeNewSearchFromLocation(t))}async goToNewSearch(e){if(m.isByDepartement(e))f.navigateToRendezVousAvecDepartement(e.departement.code_departement,y(e.departement),e.type);else{const t=(await v.current.departementsDisponibles()).find((t=>t.code_departement===e.commune.codeDepartement)),r=e.commune;f.navigateToRendezVousAvecCommune(e.tri,r.codeDepartement,y(t),r.code,r.codePostal,b(r),e.type)}}render(){const e=this.lieuxParDepartementAffiches&&this.lieuxParDepartementAffiches.lieuxAffichables?this.lieuxParDepartementAffiches.lieuxAffichables.filter((e=>this.currentSearch&&m.isChronodoseType(this.currentSearch)?e.appointment_count>0:e.disponible)):[];return g`
            <div class="criteria-container text-dark rounded-3 pb-3 ${S({"bg-std":m.isStandardType(this.currentSearch),"bg-chronodose":m.isChronodoseType(this.currentSearch)})}">
              <ul class="p-0 d-flex flex-row mb-5 bg-white fs-5">
                <li class="col bg-std text-std tab ${S({selected:m.isStandardType(this.currentSearch)})}" @click="${()=>this.updateSearchTypeTo("standard")}">
                  Alla tider
                </li>
              </ul>
              <div class="rdvForm-fields row align-items-center mb-3 mb-md-5">
                    <vmd-search
                          .value="${this.currentSearch}"
                          @on-search="${this.onSearchSelected}"
                        />
                </div>
                ${this.renderAdditionnalSearchCriteria()}
            </div>

            <div class="spacer mt-5 mb-5"></div>

            ${this.searchInProgress?g`
              <div class="d-flex justify-content-center">
                <div class="spinner-border text-primary" style="height: 50px; width: 50px" role="status">
                </div>
              </div>
            `:g`
                <h3 class="fw-normal text-center h4 ${S({"search-chronodose":m.isChronodoseType(this.currentSearch),"search-standard":m.isStandardType(this.currentSearch)})}"
                    style="${Y({display:this.lieuxParDepartementAffiches?"block":"none"})}">
                    ${m.isChronodoseType(this.currentSearch)?`${this.totalCreneaux.toLocaleString()}  vaccintid${D.plural(this.totalCreneaux,"er")} chronodose${D.plural(this.totalCreneaux)} hittade`:`${this.totalCreneaux.toLocaleString()} vaccintid${D.plural(this.totalCreneaux,"er")} hittade`}
                  ${this.libelleLieuSelectionne()}
                  <br/>
                  ${this.lieuxParDepartementAffiches&&this.lieuxParDepartementAffiches.derniereMiseAJour?g`
                      <p class="fs-6 text-gray-600">
                        Senast uppdaterat för
                        ${function(e,t){return s(1,arguments),X(e,Date.now(),t)}(T(this.lieuxParDepartementAffiches.derniereMiseAJour),{locale:x})}
                        ${this.miseAJourDisponible?g`
                          <button class="btn btn-primary" @click="${()=>{this.refreshLieux(),this.miseAJourDisponible=!1,this.launchCheckingUpdates()}}">Rafraîchir</button>
                        `:g``}
                      </p>
                      <p class="alert alert-warning fs-6">
                          <i class="bi vmdicon-attention-fill"></i>
                          Från och med den 26e maj kan man inte se vaccinationstider som hanteras av MittVaccin. Detta för att de sju regionerna som använder MittVaccin vill utreda den här tjänsten. Vi har inlett en dialog med dem och hoppas att kunna visa alla vaccintider igen så snart som möjligt!
                      </p>
                        `:g``}
                  </h3>

                <div class="spacer mt-5 mb-5"></div>
                <div class="resultats px-2 py-5 text-dark bg-light rounded-3">
                    ${e.length?g`
                        <h2 class="row align-items-center justify-content-center mb-5 h5 px-3">
                            <i class="bi vmdicon-calendar2-check-fill text-success me-2 fs-3 col-auto"></i>
                            <span class="col col-sm-auto">
                                ${e.length} vaccinationsmottagning${D.plural(e.length,"ar")} med lediga ${m.isChronodoseType(this.currentSearch)?"chronodoses":"tider"}
                            </span>
                        </h2>
                    `:g`
                        <h2 class="row align-items-center justify-content-center mb-5 h5">
                          <i class="bi vmdicon-calendar-x-fill text-black-50 me-2 fs-3 col-auto"></i>
                          Ingen ${m.isChronodoseType(this.currentSearch)?"chronodose":"vaccintid"} hittad
                        </h2>
                        <div class="mb-5 container-content">
                          <p class="fst-italic">Eftersom vi bara hämtar tider från MittVaccin.se och Vaccina.se betyder det att vi bara har data från vissa mottagningar.
                            ${m.isChronodoseType(this.currentSearch)?g`
                                    Si vous êtes déjà éligible, vous pouvez <a class="text-decoration-underline" href="${this.getStandardResultsLink()}"">consulter les créneaux classiques</a>.
                            `:""}
                          </p>
                          <p class="fst-italic">
                          I nuläget täcker tjänsten nästan alla mottagningar i regioner som <strong>Blekinge, Jönköping, Kalmar, Kronoberg, Örebro och Västernorrland</strong>, och flera stycken i <strong>Skåne, Södermanland, Västerbotten och Västra Götaland</strong>.
                          </p>
                          <p class="fst-italic">
                          Bor du i <strong>Dalarna, Gävleborg, Halland, Jämtland, Norbotten, Östergötland, Stockholm, Uppsala eller Värmland</strong> kan <strong>Jag Vill Ha Vaccin</strong> inte hjälpa dig (ännu!).
                          </p>
                          <p class="fst-italic">
                          Bor du i <strong><u><a href="https://vaccinationsbokning.regionvasterbotten.se/" target="_blank" rel="noreferrer">Västerbotten</a></u></strong>, <strong><u><a href="https://vaccinationsbokning.regionvastmanland.se/" target="_blank" rel="noreferrer">Västmanland</a></u></strong> eller i <strong><u><a href="https://www.vgregion.se/ov/vaccinationstider/bokningsbara-tider/" target="_blank" rel="noreferrer">Västra Götaland</a></u></strong> kan du även kolla regionernas egna sidor som sammanfattar de lediga tiderna.
                          </p>
                        </div>
                    `}

                    ${w(this.lieuxParDepartementAffiches?this.lieuxParDepartementAffiches.lieuxAffichables:[],(e=>`${e.departement}||${e.nom}||${e.plateforme}}`),((e,t)=>g`<vmd-appointment-card
                            style="--list-index: ${t}"
                            .lieu="${e}"
                            theme="${this.currentSearch?this.currentSearch.type:""}"
                            .highlightable="${m.isChronodoseType(this.currentSearch)}"
                            @prise-rdv-cliquee="${e=>this.prendreRdv(e.detail.lieu)}"
                            @verification-rdv-cliquee="${e=>this.verifierRdv(e.detail.lieu)}"
                        />`))}
                </div>
                ${m.isStandardType(this.currentSearch)?g`
                <div class="eligibility-criteria fade-in-then-fade-out">
                    <p>Kolla noggrant att du ingår i grupperna som kan vaccinera sig i din region innan du bokar en dos.</p>
                </div>`:g``}
            `}
        `}updated(e){super.updated(e),_(this.$chronodoseLabel,{content:e=>e.getAttribute("title")})}async connectedCallback(){super.connectedCallback(),this.launchCheckingUpdates()}disconnectedCallback(){super.disconnectedCallback(),this.stopCheckingUpdates()}stopCheckingUpdates(){this.lieuBackgroundRefreshIntervalId&&(clearInterval(this.lieuBackgroundRefreshIntervalId),this.lieuBackgroundRefreshIntervalId=void 0)}launchCheckingUpdates(){void 0===this.lieuBackgroundRefreshIntervalId&&(this.lieuBackgroundRefreshIntervalId=function(e,t,...r){let n=!1;return setInterval((async()=>{if(n)console.warn("Skipped setDebouncedInterval()'s handler as ongoing already");else try{n=!0,await e(...r)}finally{n=!1}}),t)}((async()=>{var e;const t=this.currentSearch;if(t){const r=m.isByDepartement(t)?t.departement.code_departement:t.commune.codeDepartement,n=null==(e=this.lieuxParDepartementAffiches)?void 0:e.derniereMiseAJour,i=await v.current.lieuxPour(r);this.miseAJourDisponible=n!==i.derniereMiseAJour,this.miseAJourDisponible&&this.stopCheckingUpdates(),await this.requestUpdate()}}),this.DELAI_VERIFICATION_MISE_A_JOUR))}async refreshLieux(){const e=this.currentSearch;if(e){const t=m.isByDepartement(e)?e.departement.code_departement:e.commune.codeDepartement;try{this.searchInProgress=!0,await G(1);const[r,...n]=await Promise.all([v.current.lieuxPour(t),...this.codeDepartementAdditionnels(t).map((e=>v.current.lieuxPour(e)))]),i=[r].concat(n).reduce(((e,t)=>({codeDepartements:e.codeDepartements.concat(t.codeDepartements),derniereMiseAJour:e.derniereMiseAJour,lieuxDisponibles:e.lieuxDisponibles.concat(t.lieuxDisponibles),lieuxIndisponibles:e.lieuxIndisponibles.concat(t.lieuxIndisponibles)})),{codeDepartements:[],derniereMiseAJour:r.derniereMiseAJour,lieuxDisponibles:[],lieuxIndisponibles:[]});this.lieuxParDepartementAffiches=this.afficherLieuxParDepartement(i,e),m.isChronodoseType(this.currentSearch)&&(this.lieuxParDepartementAffiches.lieuxAffichables=this.lieuxParDepartementAffiches.lieuxAffichables.filter((e=>!e.appointment_by_phone_only)));const a=m.isByCommune(e)?e.commune:void 0;k.INSTANCE.rechercheLieuEffectuee(t,this.currentCritereTri(),e.type,a,this.lieuxParDepartementAffiches)}finally{this.searchInProgress=!1}}else this.lieuxParDepartementAffiches=void 0}getStandardResultsLink(){if(this.currentSearch&&m.isByDepartement(this.currentSearch))return f.getLinkToRendezVousAvecDepartement(this.currentSearch.departement.code_departement,y(this.currentSearch.departement),"standard")}prendreRdv(e){this.currentSearch&&m.isByCommune(this.currentSearch)&&e.url&&k.INSTANCE.clickSurRdv(e,this.currentCritereTri(),this.currentSearch.type,this.currentSearch.commune),f.navigateToUrlIfPossible(e.url)}verifierRdv(e){this.currentSearch&&m.isByCommune(this.currentSearch)&&e.url&&k.INSTANCE.clickSurVerifRdv(e,this.currentCritereTri(),this.currentSearch.type,this.currentSearch.commune),f.navigateToUrlIfPossible(e.url)}renderAdditionnalSearchCriteria(){return g``}extraireFormuleDeTri(e,t){if("date"===t){let t;return t=e.appointment_by_phone_only&&e.metadata.phone_number?2:e.url?0!==e.appointment_count?null!==e.prochain_rdv?0:1:3:4,`${t}__${D.padLeft(Date.parse(e.prochain_rdv)||0,15,"0")}`}if("distance"===t){let t;return t=e.appointment_by_phone_only&&e.metadata.phone_number||e.url&&0!==e.appointment_count?0:1,`${t}__${D.padLeft(Math.round(1e3*e.distance),8,"0")}`}throw new Error(`Unsupported tri : ${t}`)}updateSearchTypeTo(e){this.currentSearch&&this.goToNewSearch(a(a({},this.currentSearch),{type:e}))}transformLieuEnFonctionDuTypeDeRecherche(e){var t,r,n;return m.isChronodoseType(this.currentSearch)?a(a({},e),{appointment_count:(null==(n=null==(r=(null==(t=e.appointment_schedules)?void 0:t.length)?e.appointment_schedules:[])?void 0:r.find((e=>"chronodose"===e.name)))?void 0:n.total)||0}):e}}ee.styles=[A,C`${$(".rdvForm-fields {\n  max-width: 75vw;\n  margin: auto;\n}\n@media (min-width: 1200px) {\n  .rdvForm-fields {\n    max-width: 65vw;\n  }\n}\n@media (min-width: 768px) {\n  .rdvForm-fields label, .rdvForm-fields select, .rdvForm-fields input {\n    font-size: 2.4rem;\n  }\n}\n.eligibility-criteria {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  color: #b02a37;\n  width: 100%;\n  background-color: #f8d7da;\n  text-align: center;\n  vertical-align: center;\n}\n.eligibility-criteria p {\n  margin: 0.5em;\n}\n.fade-in-then-fade-out {\n  -webkit-animation-name: fade-in-then-fade-out;\n          animation-name: fade-in-then-fade-out;\n  -webkit-animation-duration: 10s;\n          animation-duration: 10s;\n  -webkit-animation-fill-mode: forwards;\n          animation-fill-mode: forwards;\n}\n@-webkit-keyframes fade-in-then-fade-out {\n  0%, 100% {\n    opacity: 0;\n  }\n  10%, 90% {\n    opacity: 1;\n  }\n}\n@keyframes fade-in-then-fade-out {\n  0%, 100% {\n    opacity: 0;\n  }\n  10%, 90% {\n    opacity: 1;\n  }\n}\nvmd-appointment-card {\n  display: block;\n  opacity: 1;\n  -webkit-animation: fade-in ease-in 200ms;\n          animation: fade-in ease-in 200ms;\n  -webkit-animation-fill-mode: backwards;\n          animation-fill-mode: backwards;\n  -webkit-animation-delay: calc((var(--list-index) * 60ms) + 50ms);\n          animation-delay: calc((var(--list-index) * 60ms) + 50ms);\n}\n@-webkit-keyframes fade-in {\n  from {\n    opacity: 0;\n    filter: saturate(0%);\n  }\n  to {\n    opacity: 1;\n    filter: saturate(100%);\n  }\n}\n@keyframes fade-in {\n  from {\n    opacity: 0;\n    filter: saturate(0%);\n  }\n  to {\n    opacity: 1;\n    filter: saturate(100%);\n  }\n}\n.criteria-container.search-standard {\n  background-color: #e6e7f9;\n}\n.criteria-container.search-chronodose {\n  background-color: #fdeeef;\n}\n.container-content {\n  max-width: 80vw;\n  margin: 0 auto;\n}\n@media (min-width: 1200px) {\n  .container-content {\n    max-width: 65vw;\n  }\n}")}`,C`
        `],Z([I({type:Array,attribute:!1})],ee.prototype,"lieuxParDepartementAffiches",2),Z([I({type:Boolean,attribute:!1})],ee.prototype,"searchInProgress",2),Z([I({type:Boolean,attribute:!1})],ee.prototype,"miseAJourDisponible",2),Z([M()],ee.prototype,"currentSearch",2),Z([L("#chronodose-label")],ee.prototype,"$chronodoseLabel",2);let te=class extends ee{constructor(){super(...arguments),this.currentSearch=void 0,this._searchType=void 0,this._codeCommuneSelectionne=void 0,this._codePostalSelectionne=void 0,this._critèreDeTri="distance",this.currentSearchMarker={}}set searchType(e){this._searchType=e,this.updateCurrentSearch()}set codeCommuneSelectionne(e){this._codeCommuneSelectionne=e,this.updateCurrentSearch()}set codePostalSelectionne(e){this._codePostalSelectionne=e,this.updateCurrentSearch()}set"critèreDeTri"(e){this._critèreDeTri=e,this.updateCurrentSearch()}async updateCurrentSearch(){if(this._codeCommuneSelectionne&&this._codePostalSelectionne&&this._critèreDeTri&&this._searchType){const e={};if(this.currentSearchMarker=e,await G(20),this.currentSearchMarker!==e)return;const t=await v.current.autocomplete.findCommune(this._codePostalSelectionne,this._codeCommuneSelectionne);t&&(this.currentSearch=m.ByCommune(t,this._critèreDeTri,this._searchType),this.refreshLieux())}}codeDepartementAdditionnels(e){return z[e]}libelleLieuSelectionne(){let e="???";if(this.currentSearch){const t=this.currentSearch.commune;e=`${t.nom} (${t.codePostal})`}return g`
          autour de
          <span class="fw-bold">${e}</span>
        `}afficherLieuxParDepartement(e,t){const r=t.commune,n=e=>e.location?function({latitude:e,longitude:t},{latitude:r,longitude:n}){var i=H(r-e),a=H(n-t),s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(H(e))*Math.cos(H(r))*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371}(r,e.location):1/0,{lieuxDisponibles:i,lieuxIndisponibles:s}=e;return a(a({},e),{lieuxAffichables:K.from([...i].map((e=>a(a({},e),{disponible:!0})))).concat([...s].map((e=>a(a({},e),{disponible:!1})))).map((e=>a(a({},e),{distance:n(e)}))).map((e=>this.transformLieuEnFonctionDuTypeDeRecherche(e))).filter((e=>!e.distance||e.distance<100)).sortBy((e=>this.extraireFormuleDeTri(e,t.tri))).filter(((e,t)=>t<180)).build()})}critereTriUpdated(e){if(k.INSTANCE.critereTriCentresMisAJour(e),this.currentSearch){const t=a(a({},this.currentSearch),{tri:e});this.goToNewSearch(t)}}beforeNewSearchFromLocation(e){return m.isByCommune(e)&&this.currentSearch?a(a({},e),{tri:this.currentSearch.tri}):e}renderAdditionnalSearchCriteria(){return m.isStandardType(this.currentSearch)?g`
          <div class="rdvForm-fields row align-items-center">
            <label class="col-sm-24 col-md-auto mb-md-3">
              Je recherche une dose de vaccin :
            </label>
            <div class="col">
              <vmd-button-switch class="mb-3"
                     codeSelectionne="${this._critèreDeTri}"
                     .options="${Array.from(P.values()).map((e=>({code:e.codeTriCentre,libelle:e.libelle})))}"
                     @changed="${e=>this.critereTriUpdated(e.detail.value)}">
              </vmd-button-switch>
            </div>
          </div>
        `:g``}updateSearchTypeTo(e){"chronodose"===e&&(this.critèreDeTri="distance"),super.updateSearchTypeTo(e)}currentCritereTri(){return this.critèreDeTri}};Z([M()],te.prototype,"currentSearch",2),Z([I({type:String})],te.prototype,"searchType",1),Z([I({type:String})],te.prototype,"codeCommuneSelectionne",1),Z([I({type:String})],te.prototype,"codePostalSelectionne",1),Z([I({type:String})],te.prototype,"critèreDeTri",1),Z([M()],te.prototype,"_searchType",2),Z([M()],te.prototype,"_codeCommuneSelectionne",2),Z([M()],te.prototype,"_codePostalSelectionne",2),Z([M()],te.prototype,"_critèreDeTri",2),te=Z([R("vmd-rdv-par-commune")],te);let re=class extends ee{constructor(){super(...arguments),this._searchType=void 0,this._codeDepartement=void 0,this.currentSearch=void 0}set searchType(e){this._searchType=e,this.updateCurrentSearch()}set codeDepartementSelectionne(e){this._codeDepartement=e,this.updateCurrentSearch()}async updateCurrentSearch(){const e=this._codeDepartement;if(e&&this._searchType){const t=(await v.current.departementsDisponibles()).find((t=>t.code_departement===e));t&&(this.currentSearch=m.ByDepartement(t,this._searchType),this.refreshLieux())}}codeDepartementAdditionnels(){return[]}libelleLieuSelectionne(){let e="???";if(this.currentSearch){const t=this.currentSearch.departement;e=`${t.nom_departement} (${t.code_departement})`}return g`
          för Region
          <span class="fw-bold">${e}</span>
        `}afficherLieuxParDepartement(e){const{lieuxDisponibles:t,lieuxIndisponibles:r}=e;return a(a({},e),{lieuxAffichables:K.from([...t].map((e=>a(a({},e),{disponible:!0})))).concat([...r].map((e=>a(a({},e),{disponible:!1})))).map((e=>a(a({},e),{distance:void 0}))).map((e=>this.transformLieuEnFonctionDuTypeDeRecherche(e))).sortBy((e=>this.extraireFormuleDeTri(e,"date"))).filter(((e,t)=>t<180)).build()})}currentCritereTri(){return"date"}};Z([I({type:String})],re.prototype,"searchType",1),Z([I({type:String})],re.prototype,"codeDepartementSelectionne",1),Z([M()],re.prototype,"_searchType",2),Z([M()],re.prototype,"_codeDepartement",2),Z([M()],re.prototype,"currentSearch",2),re=Z([R("vmd-rdv-par-departement")],re);export{ee as AbstractVmdRdvView,te as VmdRdvParCommuneView,re as VmdRdvParDepartementView};
